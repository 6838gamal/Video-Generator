<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ù…ÙˆÙ„Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø°ÙƒÙŠ</title>

<style>

/* ===== Reset ===== */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: system-ui, sans-serif;
}

/* ===== Background ===== */
body{
    min-height:100vh;
    background: linear-gradient(135deg,#0f172a,#020617);
    color:white;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:15px;
}

/* ===== Container ===== */
.container{
    width:100%;
    max-width:520px;
    background: rgba(255,255,255,0.06);
    backdrop-filter: blur(15px);
    border-radius:18px;
    padding:25px;
    box-shadow:0 0 40px rgba(0,0,0,0.4);
}

/* ===== Title ===== */
.title{
    text-align:center;
    margin-bottom:25px;
    font-size:22px;
    font-weight:bold;
}

/* ===== Input ===== */
.input-group{
    margin-bottom:18px;
}

input{
    width:100%;
    padding:14px;
    border-radius:12px;
    border:none;
    outline:none;
    background:#020617;
    color:white;
    font-size:14px;
}

/* ===== Button ===== */
button{
    width:100%;
    padding:14px;
    border:none;
    border-radius:12px;
    font-size:15px;
    background:#4f46e5;
    color:white;
    cursor:pointer;
    transition:0.3s;
}

button:hover{
    background:#6366f1;
}

/* ===== Progress ===== */
.progress-box{
    margin-top:25px;
}

.progress-bar{
    height:16px;
    width:100%;
    background:#020617;
    border-radius:10px;
    overflow:hidden;
}

.progress-fill{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#22c55e,#4ade80);
    transition:0.4s;
    text-align:center;
    font-size:12px;
}

/* ===== Stage ===== */
.stage{
    margin-top:10px;
    font-size:14px;
    opacity:0.9;
    text-align:center;
}

/* ===== Video ===== */
video{
    margin-top:20px;
    width:100%;
    border-radius:12px;
    display:none;
}

/* ===== Download ===== */
.download{
    display:none;
    margin-top:12px;
    text-align:center;
    text-decoration:none;
    color:#4ade80;
}

/* ===== Responsive ===== */
@media(max-width:480px){

    .container{
        padding:18px;
    }

    .title{
        font-size:18px;
    }

    input,button{
        font-size:13px;
        padding:12px;
    }

}

</style>
</head>


<body>

<div class="container">

<div class="title">
ğŸ¬ Ù…ÙˆÙ„Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
</div>

<form id="form">

<div class="input-group">
<input name="prompt" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ..." required>
</div>

<div class="input-group">
<input name="filename" placeholder="Ø§Ø³Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ" required>
</div>

<button>ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>

</form>

<div class="progress-box">

<div class="progress-bar">
<div class="progress-fill" id="progress-bar">0%</div>
</div>

<div class="stage" id="stage"></div>

</div>

<video id="video" controls></video>
<a id="download" class="download">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a>

</div>

<script>

document.getElementById("form").onsubmit = async (e)=>{
    e.preventDefault()

    let formData = new FormData(e.target)

    let res = await fetch("/generate",{
        method:"POST",
        body:formData
    })

    let data = await res.json()
    checkProgress(data.job_id)
}

async function checkProgress(job_id){

    let interval = setInterval(async ()=>{

        let res = await fetch("/progress/"+job_id)
        let data = await res.json()

        let bar = document.getElementById("progress-bar")
        bar.style.width = data.progress + "%"
        bar.innerText = data.progress + "%"

        document.getElementById("stage").innerText = data.stage || ""

        if(data.progress === 100){

            clearInterval(interval)

            let videoUrl = "/video/" + data.video

            let video = document.getElementById("video")
            video.src = videoUrl
            video.style.display = "block"

            let dl = document.getElementById("download")
            dl.href = videoUrl
            dl.style.display = "block"
        }

        if(data.progress === -1){
            clearInterval(interval)
            document.getElementById("stage").innerText =
            "âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£: " + data.stage
        }

    },1000)
}

</script>

</body>
</html>
